[build]
builder = "RAILPACK" # Use the latest builder

[build.setup]
# Force pnpm and a modern node version via nixPkgs
nixPkgs = ["nodejs_22", "pnpm"]
# Generate Prisma before building
commands = ["pnpm --filter finance-tracker exec prisma generate"]

[deploy]
buildCommand = "pnpm build:app:finance-tracker"
startCommand = "pnpm start:app:finance-tracker"

[environments]
RAILWAY_ROOT_DIRECTORY = "/"
# These are redundant but helpful "hammers" to ensure the builder obeys
NIXPACKS_NODE_VERSION = "22"
PACKAGE_MANAGER = "pnpm"